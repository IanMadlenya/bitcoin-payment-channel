<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Network.Haskoin.Script</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Network-Haskoin-Script.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Network-Haskoin-Script.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">haskoin-core-0.3.0: Implementation of the core Bitcoin protocol features.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell98</td></tr></table><p class="caption">Network.Haskoin.Script</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Scripts</a></li><li><a href="#g:2">Script Parsing</a><ul><li><a href="#g:3">Script Outputs</a></li><li><a href="#g:4">Script Inputs</a></li></ul></li><li><a href="#g:5">Helpers</a></li><li><a href="#g:6">SigHash</a></li><li><a href="#g:7">Evaluation</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This package provides functions for parsing and evaluating bitcoin
  transaction scripts. Data types are provided for building and
  deconstructing all of the standard input and output script types.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:Script">Script</a> = <a href="#v:Script">Script</a> {<ul class="subs"><li><a href="#v:scriptOps">scriptOps</a> :: ![<a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a>]</li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:ScriptOp">ScriptOp</a><ul class="subs"><li>= <a href="#v:OP_PUSHDATA">OP_PUSHDATA</a> !<a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a> !<a href="Network-Haskoin-Script.html#t:PushDataType">PushDataType</a></li><li>| <a href="#v:OP_0">OP_0</a></li><li>| <a href="#v:OP_1NEGATE">OP_1NEGATE</a></li><li>| <a href="#v:OP_RESERVED">OP_RESERVED</a></li><li>| <a href="#v:OP_1">OP_1</a></li><li>| <a href="#v:OP_2">OP_2</a></li><li>| <a href="#v:OP_3">OP_3</a></li><li>| <a href="#v:OP_4">OP_4</a></li><li>| <a href="#v:OP_5">OP_5</a></li><li>| <a href="#v:OP_6">OP_6</a></li><li>| <a href="#v:OP_7">OP_7</a></li><li>| <a href="#v:OP_8">OP_8</a></li><li>| <a href="#v:OP_9">OP_9</a></li><li>| <a href="#v:OP_10">OP_10</a></li><li>| <a href="#v:OP_11">OP_11</a></li><li>| <a href="#v:OP_12">OP_12</a></li><li>| <a href="#v:OP_13">OP_13</a></li><li>| <a href="#v:OP_14">OP_14</a></li><li>| <a href="#v:OP_15">OP_15</a></li><li>| <a href="#v:OP_16">OP_16</a></li><li>| <a href="#v:OP_NOP">OP_NOP</a></li><li>| <a href="#v:OP_VER">OP_VER</a></li><li>| <a href="#v:OP_IF">OP_IF</a></li><li>| <a href="#v:OP_NOTIF">OP_NOTIF</a></li><li>| <a href="#v:OP_VERIF">OP_VERIF</a></li><li>| <a href="#v:OP_VERNOTIF">OP_VERNOTIF</a></li><li>| <a href="#v:OP_ELSE">OP_ELSE</a></li><li>| <a href="#v:OP_ENDIF">OP_ENDIF</a></li><li>| <a href="#v:OP_VERIFY">OP_VERIFY</a></li><li>| <a href="#v:OP_RETURN">OP_RETURN</a></li><li>| <a href="#v:OP_TOALTSTACK">OP_TOALTSTACK</a></li><li>| <a href="#v:OP_FROMALTSTACK">OP_FROMALTSTACK</a></li><li>| <a href="#v:OP_IFDUP">OP_IFDUP</a></li><li>| <a href="#v:OP_DEPTH">OP_DEPTH</a></li><li>| <a href="#v:OP_DROP">OP_DROP</a></li><li>| <a href="#v:OP_DUP">OP_DUP</a></li><li>| <a href="#v:OP_NIP">OP_NIP</a></li><li>| <a href="#v:OP_OVER">OP_OVER</a></li><li>| <a href="#v:OP_PICK">OP_PICK</a></li><li>| <a href="#v:OP_ROLL">OP_ROLL</a></li><li>| <a href="#v:OP_ROT">OP_ROT</a></li><li>| <a href="#v:OP_SWAP">OP_SWAP</a></li><li>| <a href="#v:OP_TUCK">OP_TUCK</a></li><li>| <a href="#v:OP_2DROP">OP_2DROP</a></li><li>| <a href="#v:OP_2DUP">OP_2DUP</a></li><li>| <a href="#v:OP_3DUP">OP_3DUP</a></li><li>| <a href="#v:OP_2OVER">OP_2OVER</a></li><li>| <a href="#v:OP_2ROT">OP_2ROT</a></li><li>| <a href="#v:OP_2SWAP">OP_2SWAP</a></li><li>| <a href="#v:OP_CAT">OP_CAT</a></li><li>| <a href="#v:OP_SUBSTR">OP_SUBSTR</a></li><li>| <a href="#v:OP_LEFT">OP_LEFT</a></li><li>| <a href="#v:OP_RIGHT">OP_RIGHT</a></li><li>| <a href="#v:OP_SIZE">OP_SIZE</a></li><li>| <a href="#v:OP_INVERT">OP_INVERT</a></li><li>| <a href="#v:OP_AND">OP_AND</a></li><li>| <a href="#v:OP_OR">OP_OR</a></li><li>| <a href="#v:OP_XOR">OP_XOR</a></li><li>| <a href="#v:OP_EQUAL">OP_EQUAL</a></li><li>| <a href="#v:OP_EQUALVERIFY">OP_EQUALVERIFY</a></li><li>| <a href="#v:OP_RESERVED1">OP_RESERVED1</a></li><li>| <a href="#v:OP_RESERVED2">OP_RESERVED2</a></li><li>| <a href="#v:OP_1ADD">OP_1ADD</a></li><li>| <a href="#v:OP_1SUB">OP_1SUB</a></li><li>| <a href="#v:OP_2MUL">OP_2MUL</a></li><li>| <a href="#v:OP_2DIV">OP_2DIV</a></li><li>| <a href="#v:OP_NEGATE">OP_NEGATE</a></li><li>| <a href="#v:OP_ABS">OP_ABS</a></li><li>| <a href="#v:OP_NOT">OP_NOT</a></li><li>| <a href="#v:OP_0NOTEQUAL">OP_0NOTEQUAL</a></li><li>| <a href="#v:OP_ADD">OP_ADD</a></li><li>| <a href="#v:OP_SUB">OP_SUB</a></li><li>| <a href="#v:OP_MUL">OP_MUL</a></li><li>| <a href="#v:OP_DIV">OP_DIV</a></li><li>| <a href="#v:OP_MOD">OP_MOD</a></li><li>| <a href="#v:OP_LSHIFT">OP_LSHIFT</a></li><li>| <a href="#v:OP_RSHIFT">OP_RSHIFT</a></li><li>| <a href="#v:OP_BOOLAND">OP_BOOLAND</a></li><li>| <a href="#v:OP_BOOLOR">OP_BOOLOR</a></li><li>| <a href="#v:OP_NUMEQUAL">OP_NUMEQUAL</a></li><li>| <a href="#v:OP_NUMEQUALVERIFY">OP_NUMEQUALVERIFY</a></li><li>| <a href="#v:OP_NUMNOTEQUAL">OP_NUMNOTEQUAL</a></li><li>| <a href="#v:OP_LESSTHAN">OP_LESSTHAN</a></li><li>| <a href="#v:OP_GREATERTHAN">OP_GREATERTHAN</a></li><li>| <a href="#v:OP_LESSTHANOREQUAL">OP_LESSTHANOREQUAL</a></li><li>| <a href="#v:OP_GREATERTHANOREQUAL">OP_GREATERTHANOREQUAL</a></li><li>| <a href="#v:OP_MIN">OP_MIN</a></li><li>| <a href="#v:OP_MAX">OP_MAX</a></li><li>| <a href="#v:OP_WITHIN">OP_WITHIN</a></li><li>| <a href="#v:OP_RIPEMD160">OP_RIPEMD160</a></li><li>| <a href="#v:OP_SHA1">OP_SHA1</a></li><li>| <a href="#v:OP_SHA256">OP_SHA256</a></li><li>| <a href="#v:OP_HASH160">OP_HASH160</a></li><li>| <a href="#v:OP_HASH256">OP_HASH256</a></li><li>| <a href="#v:OP_CODESEPARATOR">OP_CODESEPARATOR</a></li><li>| <a href="#v:OP_CHECKSIG">OP_CHECKSIG</a></li><li>| <a href="#v:OP_CHECKSIGVERIFY">OP_CHECKSIGVERIFY</a></li><li>| <a href="#v:OP_CHECKMULTISIG">OP_CHECKMULTISIG</a></li><li>| <a href="#v:OP_CHECKMULTISIGVERIFY">OP_CHECKMULTISIGVERIFY</a></li><li>| <a href="#v:OP_NOP1">OP_NOP1</a></li><li>| <a href="#v:OP_NOP2">OP_NOP2</a></li><li>| <a href="#v:OP_NOP3">OP_NOP3</a></li><li>| <a href="#v:OP_NOP4">OP_NOP4</a></li><li>| <a href="#v:OP_NOP5">OP_NOP5</a></li><li>| <a href="#v:OP_NOP6">OP_NOP6</a></li><li>| <a href="#v:OP_NOP7">OP_NOP7</a></li><li>| <a href="#v:OP_NOP8">OP_NOP8</a></li><li>| <a href="#v:OP_NOP9">OP_NOP9</a></li><li>| <a href="#v:OP_NOP10">OP_NOP10</a></li><li>| <a href="#v:OP_PUBKEYHASH">OP_PUBKEYHASH</a></li><li>| <a href="#v:OP_PUBKEY">OP_PUBKEY</a></li><li>| <a href="#v:OP_INVALIDOPCODE">OP_INVALIDOPCODE</a> !<a href="../base-4.8.2.0/Data-Word.html#t:Word8">Word8</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:PushDataType">PushDataType</a><ul class="subs"><li>= <a href="#v:OPCODE">OPCODE</a></li><li>| <a href="#v:OPDATA1">OPDATA1</a></li><li>| <a href="#v:OPDATA2">OPDATA2</a></li><li>| <a href="#v:OPDATA4">OPDATA4</a></li></ul></li><li class="src short"><a href="#v:opPushData">opPushData</a> :: <a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:ScriptOutput">ScriptOutput</a><ul class="subs"><li>= <a href="#v:PayPK">PayPK</a> { <ul class="subs"><li><a href="#v:getOutputPubKey">getOutputPubKey</a> :: !<a href="Network-Haskoin-Crypto.html#t:PubKey">PubKey</a></li></ul> }</li><li>| <a href="#v:PayPKHash">PayPKHash</a> { <ul class="subs"><li><a href="#v:getOutputAddress">getOutputAddress</a> :: !<a href="Network-Haskoin-Crypto.html#t:Address">Address</a></li></ul> }</li><li>| <a href="#v:PayMulSig">PayMulSig</a> { <ul class="subs"><li><a href="#v:getOutputMulSigKeys">getOutputMulSigKeys</a> :: ![<a href="Network-Haskoin-Crypto.html#t:PubKey">PubKey</a>]</li><li><a href="#v:getOutputMulSigRequired">getOutputMulSigRequired</a> :: !<a href="../base-4.8.2.0/Data-Int.html#t:Int">Int</a></li></ul> }</li><li>| <a href="#v:PayScriptHash">PayScriptHash</a> { <ul class="subs"><li><a href="#v:getOutputAddress">getOutputAddress</a> :: !<a href="Network-Haskoin-Crypto.html#t:Address">Address</a></li></ul> }</li></ul></li><li class="src short"><a href="#v:encodeOutput">encodeOutput</a> :: <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> -&gt; <a href="Network-Haskoin-Script.html#t:Script">Script</a></li><li class="src short"><a href="#v:encodeOutputBS">encodeOutputBS</a> :: <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> -&gt; <a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a></li><li class="src short"><a href="#v:decodeOutput">decodeOutput</a> :: <a href="Network-Haskoin-Script.html#t:Script">Script</a> -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Data-String.html#t:String">String</a> <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a></li><li class="src short"><a href="#v:decodeOutputBS">decodeOutputBS</a> :: <a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Data-String.html#t:String">String</a> <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a></li><li class="src short"><a href="#v:isPayPK">isPayPK</a> :: <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:isPayPKHash">isPayPKHash</a> :: <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:isPayMulSig">isPayMulSig</a> :: <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:isPayScriptHash">isPayScriptHash</a> :: <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:scriptAddr">scriptAddr</a> :: <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> -&gt; <a href="Network-Haskoin-Crypto.html#t:Address">Address</a></li><li class="src short"><a href="#v:sortMulSig">sortMulSig</a> :: <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> -&gt; <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:ScriptInput">ScriptInput</a><ul class="subs"><li>= <a href="#v:RegularInput">RegularInput</a> { <ul class="subs"><li><a href="#v:getRegularInput">getRegularInput</a> :: <a href="Network-Haskoin-Script.html#t:SimpleInput">SimpleInput</a></li></ul> }</li><li>| <a href="#v:ScriptHashInput">ScriptHashInput</a> { <ul class="subs"><li><a href="#v:getScriptHashInput">getScriptHashInput</a> :: <a href="Network-Haskoin-Script.html#t:SimpleInput">SimpleInput</a></li><li><a href="#v:getScriptHashRedeem">getScriptHashRedeem</a> :: <a href="Network-Haskoin-Script.html#t:RedeemScript">RedeemScript</a></li></ul> }</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:SimpleInput">SimpleInput</a><ul class="subs"><li>= <a href="#v:SpendPK">SpendPK</a> { <ul class="subs"><li><a href="#v:getInputSig">getInputSig</a> :: !<a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a></li></ul> }</li><li>| <a href="#v:SpendPKHash">SpendPKHash</a> { <ul class="subs"><li><a href="#v:getInputSig">getInputSig</a> :: !<a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a></li><li><a href="#v:getInputKey">getInputKey</a> :: !<a href="Network-Haskoin-Crypto.html#t:PubKey">PubKey</a></li></ul> }</li><li>| <a href="#v:SpendMulSig">SpendMulSig</a> { <ul class="subs"><li><a href="#v:getInputMulSigKeys">getInputMulSigKeys</a> :: ![<a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a>]</li></ul> }</li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:RedeemScript">RedeemScript</a> = <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a></li><li class="src short"><a href="#v:encodeInput">encodeInput</a> :: <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a> -&gt; <a href="Network-Haskoin-Script.html#t:Script">Script</a></li><li class="src short"><a href="#v:encodeInputBS">encodeInputBS</a> :: <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a> -&gt; <a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a></li><li class="src short"><a href="#v:decodeInput">decodeInput</a> :: <a href="Network-Haskoin-Script.html#t:Script">Script</a> -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Data-String.html#t:String">String</a> <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a></li><li class="src short"><a href="#v:decodeInputBS">decodeInputBS</a> :: <a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Data-String.html#t:String">String</a> <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a></li><li class="src short"><a href="#v:isSpendPK">isSpendPK</a> :: <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:isSpendPKHash">isSpendPKHash</a> :: <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:isSpendMulSig">isSpendMulSig</a> :: <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:isScriptHashInput">isScriptHashInput</a> :: <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:scriptRecipient">scriptRecipient</a> :: <a href="Network-Haskoin-Script.html#t:Script">Script</a> -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Data-String.html#t:String">String</a> <a href="Network-Haskoin-Crypto.html#t:Address">Address</a></li><li class="src short"><a href="#v:scriptSender">scriptSender</a> :: <a href="Network-Haskoin-Script.html#t:Script">Script</a> -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Data-String.html#t:String">String</a> <a href="Network-Haskoin-Crypto.html#t:Address">Address</a></li><li class="src short"><a href="#v:intToScriptOp">intToScriptOp</a> :: <a href="../base-4.8.2.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a></li><li class="src short"><a href="#v:scriptOpToInt">scriptOpToInt</a> :: <a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a> -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Data-String.html#t:String">String</a> <a href="../base-4.8.2.0/Data-Int.html#t:Int">Int</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:SigHash">SigHash</a><ul class="subs"><li>= <a href="#v:SigAll">SigAll</a> { <ul class="subs"><li><a href="#v:anyoneCanPay">anyoneCanPay</a> :: !<a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li></ul> }</li><li>| <a href="#v:SigNone">SigNone</a> { <ul class="subs"><li><a href="#v:anyoneCanPay">anyoneCanPay</a> :: !<a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li></ul> }</li><li>| <a href="#v:SigSingle">SigSingle</a> { <ul class="subs"><li><a href="#v:anyoneCanPay">anyoneCanPay</a> :: !<a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li></ul> }</li><li>| <a href="#v:SigUnknown">SigUnknown</a> { <ul class="subs"><li><a href="#v:anyoneCanPay">anyoneCanPay</a> :: !<a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li><li><a href="#v:getSigCode">getSigCode</a> :: !<a href="../base-4.8.2.0/Data-Word.html#t:Word8">Word8</a></li></ul> }</li></ul></li><li class="src short"><a href="#v:txSigHash">txSigHash</a> :: <a href="Network-Haskoin-Transaction.html#t:Tx">Tx</a> -&gt; <a href="Network-Haskoin-Script.html#t:Script">Script</a> -&gt; <a href="../base-4.8.2.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a> -&gt; <a href="Network-Haskoin-Crypto.html#t:Hash256">Hash256</a></li><li class="src short"><a href="#v:encodeSigHash32">encodeSigHash32</a> :: <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a> -&gt; <a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a></li><li class="src short"><a href="#v:isSigAll">isSigAll</a> :: <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:isSigNone">isSigNone</a> :: <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:isSigSingle">isSigSingle</a> :: <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:isSigUnknown">isSigUnknown</a> :: <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:TxSignature">TxSignature</a> = <a href="#v:TxSignature">TxSignature</a> {<ul class="subs"><li><a href="#v:txSignature">txSignature</a> :: !<a href="Network-Haskoin-Crypto.html#t:Signature">Signature</a></li><li><a href="#v:sigHashType">sigHashType</a> :: !<a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a></li></ul>}</li><li class="src short"><a href="#v:encodeSig">encodeSig</a> :: <a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a> -&gt; <a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a></li><li class="src short"><a href="#v:decodeSig">decodeSig</a> :: <a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Data-String.html#t:String">String</a> <a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a></li><li class="src short"><a href="#v:decodeCanonicalSig">decodeCanonicalSig</a> :: <a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Data-String.html#t:String">String</a> <a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a></li><li class="src short"><a href="#v:evalScript">evalScript</a> :: <a href="Network-Haskoin-Script.html#t:Script">Script</a> -&gt; <a href="Network-Haskoin-Script.html#t:Script">Script</a> -&gt; <a href="Network-Haskoin-Script.html#t:SigCheck">SigCheck</a> -&gt; [<a href="Network-Haskoin-Internals.html#t:Flag">Flag</a>] -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:verifySpend">verifySpend</a> :: <a href="Network-Haskoin-Transaction.html#t:Tx">Tx</a> -&gt; <a href="../base-4.8.2.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Network-Haskoin-Script.html#t:Script">Script</a> -&gt; [<a href="Network-Haskoin-Internals.html#t:Flag">Flag</a>] -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:SigCheck">SigCheck</a> = [<a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a>] -&gt; <a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a> -&gt; <a href="Network-Haskoin-Crypto.html#t:PubKey">PubKey</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></li></ul></div><div id="interface"><h1 id="g:1">Scripts</h1><div class="doc"><p>More informations on scripts is available here:
 <a href="http://en.bitcoin.it/wiki/Script">http://en.bitcoin.it/wiki/Script</a></p></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Script" class="def">Script</a> <a href="src/Network-Haskoin-Script-Types.html#Script" class="link">Source</a></p><div class="doc"><p>Data type representing a transaction script. Scripts are defined as lists
 of script operators <code><a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a></code>. Scripts are used to:</p><ul><li>Define the spending conditions in the output of a transaction</li><li>Provide the spending signatures in the input of a transaction</li></ul></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Script" class="def">Script</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:scriptOps" class="def">scriptOps</a> :: ![<a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a>]</dt><dd class="doc"><p>List of script operators defining this script</p></dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:Script" class="caption collapser" onclick="toggleSection('i:Script')">Instances</p><div id="section.i:Script" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Data-Eq.html#t:Eq">Eq</a> <a href="Network-Haskoin-Script.html#t:Script">Script</a></span> <a href="src/Network-Haskoin-Script-Types.html#line-43" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Read.html#t:Read">Read</a> <a href="Network-Haskoin-Script.html#t:Script">Script</a></span> <a href="src/Network-Haskoin-Script-Types.html#line-43" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> <a href="Network-Haskoin-Script.html#t:Script">Script</a></span> <a href="src/Network-Haskoin-Script-Types.html#line-43" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../binary-0.7.5.0/Data-Binary.html#t:Binary">Binary</a> <a href="Network-Haskoin-Script.html#t:Script">Script</a></span> <a href="src/Network-Haskoin-Script-Types.html#line-48" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../deepseq-1.4.1.1/Control-DeepSeq.html#t:NFData">NFData</a> <a href="Network-Haskoin-Script.html#t:Script">Script</a></span> <a href="src/Network-Haskoin-Script-Types.html#line-45" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:ScriptOp" class="def">ScriptOp</a> <a href="src/Network-Haskoin-Script-Types.html#ScriptOp" class="link">Source</a></p><div class="doc"><p>Data type representing all of the operators allowed inside a <code><a href="Network-Haskoin-Script.html#t:Script">Script</a></code>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:OP_PUSHDATA" class="def">OP_PUSHDATA</a> !<a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a> !<a href="Network-Haskoin-Script.html#t:PushDataType">PushDataType</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_0" class="def">OP_0</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_1NEGATE" class="def">OP_1NEGATE</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_RESERVED" class="def">OP_RESERVED</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_1" class="def">OP_1</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_2" class="def">OP_2</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_3" class="def">OP_3</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_4" class="def">OP_4</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_5" class="def">OP_5</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_6" class="def">OP_6</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_7" class="def">OP_7</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_8" class="def">OP_8</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_9" class="def">OP_9</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_10" class="def">OP_10</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_11" class="def">OP_11</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_12" class="def">OP_12</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_13" class="def">OP_13</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_14" class="def">OP_14</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_15" class="def">OP_15</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_16" class="def">OP_16</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_NOP" class="def">OP_NOP</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_VER" class="def">OP_VER</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_IF" class="def">OP_IF</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_NOTIF" class="def">OP_NOTIF</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_VERIF" class="def">OP_VERIF</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_VERNOTIF" class="def">OP_VERNOTIF</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_ELSE" class="def">OP_ELSE</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_ENDIF" class="def">OP_ENDIF</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_VERIFY" class="def">OP_VERIFY</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_RETURN" class="def">OP_RETURN</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_TOALTSTACK" class="def">OP_TOALTSTACK</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_FROMALTSTACK" class="def">OP_FROMALTSTACK</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_IFDUP" class="def">OP_IFDUP</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_DEPTH" class="def">OP_DEPTH</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_DROP" class="def">OP_DROP</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_DUP" class="def">OP_DUP</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_NIP" class="def">OP_NIP</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_OVER" class="def">OP_OVER</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_PICK" class="def">OP_PICK</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_ROLL" class="def">OP_ROLL</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_ROT" class="def">OP_ROT</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_SWAP" class="def">OP_SWAP</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_TUCK" class="def">OP_TUCK</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_2DROP" class="def">OP_2DROP</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_2DUP" class="def">OP_2DUP</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_3DUP" class="def">OP_3DUP</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_2OVER" class="def">OP_2OVER</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_2ROT" class="def">OP_2ROT</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_2SWAP" class="def">OP_2SWAP</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_CAT" class="def">OP_CAT</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_SUBSTR" class="def">OP_SUBSTR</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_LEFT" class="def">OP_LEFT</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_RIGHT" class="def">OP_RIGHT</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_SIZE" class="def">OP_SIZE</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_INVERT" class="def">OP_INVERT</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_AND" class="def">OP_AND</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_OR" class="def">OP_OR</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_XOR" class="def">OP_XOR</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_EQUAL" class="def">OP_EQUAL</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_EQUALVERIFY" class="def">OP_EQUALVERIFY</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_RESERVED1" class="def">OP_RESERVED1</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_RESERVED2" class="def">OP_RESERVED2</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_1ADD" class="def">OP_1ADD</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_1SUB" class="def">OP_1SUB</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_2MUL" class="def">OP_2MUL</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_2DIV" class="def">OP_2DIV</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_NEGATE" class="def">OP_NEGATE</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_ABS" class="def">OP_ABS</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_NOT" class="def">OP_NOT</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_0NOTEQUAL" class="def">OP_0NOTEQUAL</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_ADD" class="def">OP_ADD</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_SUB" class="def">OP_SUB</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_MUL" class="def">OP_MUL</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_DIV" class="def">OP_DIV</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_MOD" class="def">OP_MOD</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_LSHIFT" class="def">OP_LSHIFT</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_RSHIFT" class="def">OP_RSHIFT</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_BOOLAND" class="def">OP_BOOLAND</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_BOOLOR" class="def">OP_BOOLOR</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_NUMEQUAL" class="def">OP_NUMEQUAL</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_NUMEQUALVERIFY" class="def">OP_NUMEQUALVERIFY</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_NUMNOTEQUAL" class="def">OP_NUMNOTEQUAL</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_LESSTHAN" class="def">OP_LESSTHAN</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_GREATERTHAN" class="def">OP_GREATERTHAN</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_LESSTHANOREQUAL" class="def">OP_LESSTHANOREQUAL</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_GREATERTHANOREQUAL" class="def">OP_GREATERTHANOREQUAL</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_MIN" class="def">OP_MIN</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_MAX" class="def">OP_MAX</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_WITHIN" class="def">OP_WITHIN</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_RIPEMD160" class="def">OP_RIPEMD160</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_SHA1" class="def">OP_SHA1</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_SHA256" class="def">OP_SHA256</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_HASH160" class="def">OP_HASH160</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_HASH256" class="def">OP_HASH256</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_CODESEPARATOR" class="def">OP_CODESEPARATOR</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_CHECKSIG" class="def">OP_CHECKSIG</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_CHECKSIGVERIFY" class="def">OP_CHECKSIGVERIFY</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_CHECKMULTISIG" class="def">OP_CHECKMULTISIG</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_CHECKMULTISIGVERIFY" class="def">OP_CHECKMULTISIGVERIFY</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_NOP1" class="def">OP_NOP1</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_NOP2" class="def">OP_NOP2</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_NOP3" class="def">OP_NOP3</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_NOP4" class="def">OP_NOP4</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_NOP5" class="def">OP_NOP5</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_NOP6" class="def">OP_NOP6</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_NOP7" class="def">OP_NOP7</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_NOP8" class="def">OP_NOP8</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_NOP9" class="def">OP_NOP9</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_NOP10" class="def">OP_NOP10</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_PUBKEYHASH" class="def">OP_PUBKEYHASH</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_PUBKEY" class="def">OP_PUBKEY</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:OP_INVALIDOPCODE" class="def">OP_INVALIDOPCODE</a> !<a href="../base-4.8.2.0/Data-Word.html#t:Word8">Word8</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:ScriptOp" class="caption collapser" onclick="toggleSection('i:ScriptOp')">Instances</p><div id="section.i:ScriptOp" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Data-Eq.html#t:Eq">Eq</a> <a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a></span> <a href="src/Network-Haskoin-Script-Types.html#line-191" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Read.html#t:Read">Read</a> <a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a></span> <a href="src/Network-Haskoin-Script-Types.html#line-191" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> <a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a></span> <a href="src/Network-Haskoin-Script-Types.html#line-191" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../binary-0.7.5.0/Data-Binary.html#t:Binary">Binary</a> <a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a></span> <a href="src/Network-Haskoin-Script-Types.html#line-200" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../deepseq-1.4.1.1/Control-DeepSeq.html#t:NFData">NFData</a> <a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a></span> <a href="src/Network-Haskoin-Script-Types.html#line-194" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:PushDataType" class="def">PushDataType</a> <a href="src/Network-Haskoin-Script-Types.html#PushDataType" class="link">Source</a></p><div class="doc"><p>Data type representing the type of an OP_PUSHDATA opcode.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:OPCODE" class="def">OPCODE</a></td><td class="doc"><p>The next opcode bytes is data to be pushed onto the stack</p></td></tr><tr><td class="src"><a name="v:OPDATA1" class="def">OPDATA1</a></td><td class="doc"><p>The next byte contains the number of bytes to be pushed onto
 the stack</p></td></tr><tr><td class="src"><a name="v:OPDATA2" class="def">OPDATA2</a></td><td class="doc"><p>The next two bytes contains the number of bytes to be pushed onto
 the stack</p></td></tr><tr><td class="src"><a name="v:OPDATA4" class="def">OPDATA4</a></td><td class="doc"><p>The next four bytes contains the number of bytes to be pushed onto
 the stack</p></td></tr></table></div><div class="subs instances"><p id="control.i:PushDataType" class="caption collapser" onclick="toggleSection('i:PushDataType')">Instances</p><div id="section.i:PushDataType" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Data-Eq.html#t:Eq">Eq</a> <a href="Network-Haskoin-Script.html#t:PushDataType">PushDataType</a></span> <a href="src/Network-Haskoin-Script-Types.html#line-74" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Read.html#t:Read">Read</a> <a href="Network-Haskoin-Script.html#t:PushDataType">PushDataType</a></span> <a href="src/Network-Haskoin-Script-Types.html#line-74" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> <a href="Network-Haskoin-Script.html#t:PushDataType">PushDataType</a></span> <a href="src/Network-Haskoin-Script-Types.html#line-74" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../deepseq-1.4.1.1/Control-DeepSeq.html#t:NFData">NFData</a> <a href="Network-Haskoin-Script.html#t:PushDataType">PushDataType</a></span> <a href="src/Network-Haskoin-Script-Types.html#line-76" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:opPushData" class="def">opPushData</a> :: <a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a> <a href="src/Network-Haskoin-Script-Types.html#opPushData" class="link">Source</a></p><div class="doc"><p>Optimally encode data using one of the 4 types of data pushing opcodes</p></div></div><h1 id="g:2">Script Parsing</h1><h2 id="g:3">Script Outputs</h2><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:ScriptOutput" class="def">ScriptOutput</a> <a href="src/Network-Haskoin-Script-Parser.html#ScriptOutput" class="link">Source</a></p><div class="doc"><p>Data type describing standard transaction output scripts. Output scripts
 provide the conditions that must be fulfilled for someone to spend the
 output coins.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:PayPK" class="def">PayPK</a></td><td class="doc"><p>Pay to a public key.</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:getOutputPubKey" class="def">getOutputPubKey</a> :: !<a href="Network-Haskoin-Crypto.html#t:PubKey">PubKey</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr><tr><td class="src"><a name="v:PayPKHash" class="def">PayPKHash</a></td><td class="doc"><p>Pay to a public key hash.</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:getOutputAddress" class="def">getOutputAddress</a> :: !<a href="Network-Haskoin-Crypto.html#t:Address">Address</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr><tr><td class="src"><a name="v:PayMulSig" class="def">PayMulSig</a></td><td class="doc"><p>Pay to multiple public keys.</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:getOutputMulSigKeys" class="def">getOutputMulSigKeys</a> :: ![<a href="Network-Haskoin-Crypto.html#t:PubKey">PubKey</a>]</dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:getOutputMulSigRequired" class="def">getOutputMulSigRequired</a> :: !<a href="../base-4.8.2.0/Data-Int.html#t:Int">Int</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr><tr><td class="src"><a name="v:PayScriptHash" class="def">PayScriptHash</a></td><td class="doc"><p>Pay to a script hash.</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:getOutputAddress" class="def">getOutputAddress</a> :: !<a href="Network-Haskoin-Crypto.html#t:Address">Address</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:ScriptOutput" class="caption collapser" onclick="toggleSection('i:ScriptOutput')">Instances</p><div id="section.i:ScriptOutput" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Data-Eq.html#t:Eq">Eq</a> <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a></span> <a href="src/Network-Haskoin-Script-Parser.html#line-71" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Read.html#t:Read">Read</a> <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a></span> <a href="src/Network-Haskoin-Script-Parser.html#line-71" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a></span> <a href="src/Network-Haskoin-Script-Parser.html#line-71" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../aeson-0.9.0.1/Data-Aeson-Types.html#t:ToJSON">ToJSON</a> <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a></span> <a href="src/Network-Haskoin-Script-Parser.html#line-78" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../aeson-0.9.0.1/Data-Aeson-Types.html#t:FromJSON">FromJSON</a> <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a></span> <a href="src/Network-Haskoin-Script-Parser.html#line-73" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../deepseq-1.4.1.1/Control-DeepSeq.html#t:NFData">NFData</a> <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a></span> <a href="src/Network-Haskoin-Script-Parser.html#line-81" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:encodeOutput" class="def">encodeOutput</a> :: <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> -&gt; <a href="Network-Haskoin-Script.html#t:Script">Script</a> <a href="src/Network-Haskoin-Script-Parser.html#encodeOutput" class="link">Source</a></p><div class="doc"><p>Computes a <code><a href="Network-Haskoin-Script.html#t:Script">Script</a></code> from a <code><a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a></code>. The <code><a href="Network-Haskoin-Script.html#t:Script">Script</a></code> is a list of
 <code><a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a></code> can can be used to build a <code>Tx</code>.</p></div></div><div class="top"><p class="src"><a name="v:encodeOutputBS" class="def">encodeOutputBS</a> :: <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> -&gt; <a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a> <a href="src/Network-Haskoin-Script-Parser.html#encodeOutputBS" class="link">Source</a></p><div class="doc"><p>Similar to <code><a href="Network-Haskoin-Script.html#v:encodeOutput">encodeOutput</a></code> but encodes to a ByteString</p></div></div><div class="top"><p class="src"><a name="v:decodeOutput" class="def">decodeOutput</a> :: <a href="Network-Haskoin-Script.html#t:Script">Script</a> -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Data-String.html#t:String">String</a> <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> <a href="src/Network-Haskoin-Script-Parser.html#decodeOutput" class="link">Source</a></p><div class="doc"><p>Tries to decode a <code><a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a></code> from a <code><a href="Network-Haskoin-Script.html#t:Script">Script</a></code>. This can fail if the
 script is not recognized as any of the standard output types.</p></div></div><div class="top"><p class="src"><a name="v:decodeOutputBS" class="def">decodeOutputBS</a> :: <a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Data-String.html#t:String">String</a> <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> <a href="src/Network-Haskoin-Script-Parser.html#decodeOutputBS" class="link">Source</a></p><div class="doc"><p>Similar to <code><a href="Network-Haskoin-Script.html#v:decodeOutput">decodeOutput</a></code> but decodes from a ByteString</p></div></div><div class="top"><p class="src"><a name="v:isPayPK" class="def">isPayPK</a> :: <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Network-Haskoin-Script-Parser.html#isPayPK" class="link">Source</a></p><div class="doc"><p>Returns True if the script is a pay to public key output.</p></div></div><div class="top"><p class="src"><a name="v:isPayPKHash" class="def">isPayPKHash</a> :: <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Network-Haskoin-Script-Parser.html#isPayPKHash" class="link">Source</a></p><div class="doc"><p>Returns True if the script is a pay to public key hash output.</p></div></div><div class="top"><p class="src"><a name="v:isPayMulSig" class="def">isPayMulSig</a> :: <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Network-Haskoin-Script-Parser.html#isPayMulSig" class="link">Source</a></p><div class="doc"><p>Returns True if the script is a pay to multiple public keys output.</p></div></div><div class="top"><p class="src"><a name="v:isPayScriptHash" class="def">isPayScriptHash</a> :: <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Network-Haskoin-Script-Parser.html#isPayScriptHash" class="link">Source</a></p><div class="doc"><p>Returns true if the script is a pay to script hash output.</p></div></div><div class="top"><p class="src"><a name="v:scriptAddr" class="def">scriptAddr</a> :: <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> -&gt; <a href="Network-Haskoin-Crypto.html#t:Address">Address</a> <a href="src/Network-Haskoin-Script-Parser.html#scriptAddr" class="link">Source</a></p><div class="doc"><p>Computes a script address from a script output. This address can be used
 in a pay to script hash output.</p></div></div><div class="top"><p class="src"><a name="v:sortMulSig" class="def">sortMulSig</a> :: <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> -&gt; <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> <a href="src/Network-Haskoin-Script-Parser.html#sortMulSig" class="link">Source</a></p><div class="doc"><p>Sorts the public keys of a multisignature output in ascending order by
 comparing their serialized representations. This feature allows for easier
 multisignature account management as participants in a multisignature wallet
 will blindly agree on an ordering of the public keys without having to
 communicate.</p></div></div><h2 id="g:4">Script Inputs</h2><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:ScriptInput" class="def">ScriptInput</a> <a href="src/Network-Haskoin-Script-Parser.html#ScriptInput" class="link">Source</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:RegularInput" class="def">RegularInput</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:getRegularInput" class="def">getRegularInput</a> :: <a href="Network-Haskoin-Script.html#t:SimpleInput">SimpleInput</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr><tr><td class="src"><a name="v:ScriptHashInput" class="def">ScriptHashInput</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:getScriptHashInput" class="def">getScriptHashInput</a> :: <a href="Network-Haskoin-Script.html#t:SimpleInput">SimpleInput</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:getScriptHashRedeem" class="def">getScriptHashRedeem</a> :: <a href="Network-Haskoin-Script.html#t:RedeemScript">RedeemScript</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:ScriptInput" class="caption collapser" onclick="toggleSection('i:ScriptInput')">Instances</p><div id="section.i:ScriptInput" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Data-Eq.html#t:Eq">Eq</a> <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a></span> <a href="src/Network-Haskoin-Script-Parser.html#line-272" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Read.html#t:Read">Read</a> <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a></span> <a href="src/Network-Haskoin-Script-Parser.html#line-272" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a></span> <a href="src/Network-Haskoin-Script-Parser.html#line-272" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../deepseq-1.4.1.1/Control-DeepSeq.html#t:NFData">NFData</a> <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a></span> <a href="src/Network-Haskoin-Script-Parser.html#line-274" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:SimpleInput" class="def">SimpleInput</a> <a href="src/Network-Haskoin-Script-Parser.html#SimpleInput" class="link">Source</a></p><div class="doc"><p>Data type describing standard transaction input scripts. Input scripts
 provide the signing data required to unlock the coins of the output they are
 trying to spend.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:SpendPK" class="def">SpendPK</a></td><td class="doc"><p>Spend the coins of a PayPK output.</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:getInputSig" class="def">getInputSig</a> :: !<a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr><tr><td class="src"><a name="v:SpendPKHash" class="def">SpendPKHash</a></td><td class="doc"><p>Spend the coins of a PayPKHash output.</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:getInputSig" class="def">getInputSig</a> :: !<a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:getInputKey" class="def">getInputKey</a> :: !<a href="Network-Haskoin-Crypto.html#t:PubKey">PubKey</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr><tr><td class="src"><a name="v:SpendMulSig" class="def">SpendMulSig</a></td><td class="doc"><p>Spend the coins of a PayMulSig output.</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:getInputMulSigKeys" class="def">getInputMulSigKeys</a> :: ![<a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a>]</dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:SimpleInput" class="caption collapser" onclick="toggleSection('i:SimpleInput')">Instances</p><div id="section.i:SimpleInput" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Data-Eq.html#t:Eq">Eq</a> <a href="Network-Haskoin-Script.html#t:SimpleInput">SimpleInput</a></span> <a href="src/Network-Haskoin-Script-Parser.html#line-239" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Read.html#t:Read">Read</a> <a href="Network-Haskoin-Script.html#t:SimpleInput">SimpleInput</a></span> <a href="src/Network-Haskoin-Script-Parser.html#line-239" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> <a href="Network-Haskoin-Script.html#t:SimpleInput">SimpleInput</a></span> <a href="src/Network-Haskoin-Script-Parser.html#line-239" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../deepseq-1.4.1.1/Control-DeepSeq.html#t:NFData">NFData</a> <a href="Network-Haskoin-Script.html#t:SimpleInput">SimpleInput</a></span> <a href="src/Network-Haskoin-Script-Parser.html#line-241" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:RedeemScript" class="def">RedeemScript</a> = <a href="Network-Haskoin-Script.html#t:ScriptOutput">ScriptOutput</a> <a href="src/Network-Haskoin-Script-Parser.html#RedeemScript" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:encodeInput" class="def">encodeInput</a> :: <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a> -&gt; <a href="Network-Haskoin-Script.html#t:Script">Script</a> <a href="src/Network-Haskoin-Script-Parser.html#encodeInput" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:encodeInputBS" class="def">encodeInputBS</a> :: <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a> -&gt; <a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a> <a href="src/Network-Haskoin-Script-Parser.html#encodeInputBS" class="link">Source</a></p><div class="doc"><p>Similar to <code><a href="Network-Haskoin-Script.html#v:encodeInput">encodeInput</a></code> but encodes to a ByteString</p></div></div><div class="top"><p class="src"><a name="v:decodeInput" class="def">decodeInput</a> :: <a href="Network-Haskoin-Script.html#t:Script">Script</a> -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Data-String.html#t:String">String</a> <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a> <a href="src/Network-Haskoin-Script-Parser.html#decodeInput" class="link">Source</a></p><div class="doc"><p>Decodes a <code><a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a></code> from a <code><a href="Network-Haskoin-Script.html#t:Script">Script</a></code>. This function fails if the
 script can not be parsed as a standard script input.</p></div></div><div class="top"><p class="src"><a name="v:decodeInputBS" class="def">decodeInputBS</a> :: <a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Data-String.html#t:String">String</a> <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a> <a href="src/Network-Haskoin-Script-Parser.html#decodeInputBS" class="link">Source</a></p><div class="doc"><p>Similar to <code><a href="Network-Haskoin-Script.html#v:decodeInput">decodeInput</a></code> but decodes from a ByteString</p></div></div><div class="top"><p class="src"><a name="v:isSpendPK" class="def">isSpendPK</a> :: <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Network-Haskoin-Script-Parser.html#isSpendPK" class="link">Source</a></p><div class="doc"><p>Returns True if the input script is spending a public key.</p></div></div><div class="top"><p class="src"><a name="v:isSpendPKHash" class="def">isSpendPKHash</a> :: <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Network-Haskoin-Script-Parser.html#isSpendPKHash" class="link">Source</a></p><div class="doc"><p>Returns True if the input script is spending a public key hash.</p></div></div><div class="top"><p class="src"><a name="v:isSpendMulSig" class="def">isSpendMulSig</a> :: <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Network-Haskoin-Script-Parser.html#isSpendMulSig" class="link">Source</a></p><div class="doc"><p>Returns True if the input script is spending a multisignature output.</p></div></div><div class="top"><p class="src"><a name="v:isScriptHashInput" class="def">isScriptHashInput</a> :: <a href="Network-Haskoin-Script.html#t:ScriptInput">ScriptInput</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Network-Haskoin-Script-Parser.html#isScriptHashInput" class="link">Source</a></p></div><h1 id="g:5">Helpers</h1><div class="top"><p class="src"><a name="v:scriptRecipient" class="def">scriptRecipient</a> :: <a href="Network-Haskoin-Script.html#t:Script">Script</a> -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Data-String.html#t:String">String</a> <a href="Network-Haskoin-Crypto.html#t:Address">Address</a> <a href="src/Network-Haskoin-Script-Parser.html#scriptRecipient" class="link">Source</a></p><div class="doc"><p>Computes the recipient address of a script. This function fails if the
 script could not be decoded as a pay to public key hash or pay to script
 hash.</p></div></div><div class="top"><p class="src"><a name="v:scriptSender" class="def">scriptSender</a> :: <a href="Network-Haskoin-Script.html#t:Script">Script</a> -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Data-String.html#t:String">String</a> <a href="Network-Haskoin-Crypto.html#t:Address">Address</a> <a href="src/Network-Haskoin-Script-Parser.html#scriptSender" class="link">Source</a></p><div class="doc"><p>Computes the sender address of a script. This function fails if the
 script could not be decoded as a spend public key hash or script hash
 input.</p></div></div><div class="top"><p class="src"><a name="v:intToScriptOp" class="def">intToScriptOp</a> :: <a href="../base-4.8.2.0/Data-Int.html#t:Int">Int</a> -&gt; <a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a> <a href="src/Network-Haskoin-Script-Parser.html#intToScriptOp" class="link">Source</a></p><div class="doc"><p>Transforms integers [1 .. 16] to <code><a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a></code> [OP_1 .. OP_16]</p></div></div><div class="top"><p class="src"><a name="v:scriptOpToInt" class="def">scriptOpToInt</a> :: <a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a> -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Data-String.html#t:String">String</a> <a href="../base-4.8.2.0/Data-Int.html#t:Int">Int</a> <a href="src/Network-Haskoin-Script-Parser.html#scriptOpToInt" class="link">Source</a></p><div class="doc"><p>Decode <code><a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a></code> [OP_1 .. OP_16] to integers [1 .. 16]. This functions
 fails for other values of <code><a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a></code></p></div></div><h1 id="g:6">SigHash</h1><div class="doc"><p>For additional information on sighashes, see:
 <a href="http://en.bitcoin.it/wiki/OP_CHECKSIG">http://en.bitcoin.it/wiki/OP_CHECKSIG</a></p></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:SigHash" class="def">SigHash</a> <a href="src/Network-Haskoin-Script-SigHash.html#SigHash" class="link">Source</a></p><div class="doc"><p>Data type representing the different ways a transaction can be signed.
 When producing a signature, a hash of the transaction is used as the message
 to be signed. The <code><a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a></code> parameter controls which parts of the
 transaction are used or ignored to produce the transaction hash. The idea is
 that if some part of a transaction is not used to produce the transaction
 hash, then you can change that part of the transaction after producing a
 signature without invalidating that signature.</p><p>If the anyoneCanPay flag is True, then only the current input is signed.
 Otherwise, all of the inputs of a transaction are signed. The default value
 for anyoneCanPay is False.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:SigAll" class="def">SigAll</a></td><td class="doc"><p>Sign all of the outputs of a transaction (This is the default value).
 Changing any of the outputs of the transaction will invalidate the
 signature.</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:anyoneCanPay" class="def">anyoneCanPay</a> :: !<a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr><tr><td class="src"><a name="v:SigNone" class="def">SigNone</a></td><td class="doc"><p>Sign none of the outputs of a transaction. This allows anyone to
 change any of the outputs of the transaction.</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:anyoneCanPay" class="def">anyoneCanPay</a> :: !<a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr><tr><td class="src"><a name="v:SigSingle" class="def">SigSingle</a></td><td class="doc"><p>Sign only the output corresponding the the current transaction input.
 You care about your own output in the transaction but you don't
 care about any of the other outputs.</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:anyoneCanPay" class="def">anyoneCanPay</a> :: !<a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr><tr><td class="src"><a name="v:SigUnknown" class="def">SigUnknown</a></td><td class="doc"><p>Unrecognized sighash types will decode to SigUnknown.</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:anyoneCanPay" class="def">anyoneCanPay</a> :: !<a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:getSigCode" class="def">getSigCode</a> :: !<a href="../base-4.8.2.0/Data-Word.html#t:Word8">Word8</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:SigHash" class="caption collapser" onclick="toggleSection('i:SigHash')">Instances</p><div id="section.i:SigHash" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Data-Eq.html#t:Eq">Eq</a> <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a></span> <a href="src/Network-Haskoin-Script-SigHash.html#line-69" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Read.html#t:Read">Read</a> <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a></span> <a href="src/Network-Haskoin-Script-SigHash.html#line-69" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a></span> <a href="src/Network-Haskoin-Script-SigHash.html#line-69" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../aeson-0.9.0.1/Data-Aeson-Types.html#t:ToJSON">ToJSON</a> <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a></span> <a href="src/Network-Haskoin-Script-SigHash.html#line-117" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../aeson-0.9.0.1/Data-Aeson-Types.html#t:FromJSON">FromJSON</a> <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a></span> <a href="src/Network-Haskoin-Script-SigHash.html#line-120" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../binary-0.7.5.0/Data-Binary.html#t:Binary">Binary</a> <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a></span> <a href="src/Network-Haskoin-Script-SigHash.html#line-101" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../deepseq-1.4.1.1/Control-DeepSeq.html#t:NFData">NFData</a> <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a></span> <a href="src/Network-Haskoin-Script-SigHash.html#line-71" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:txSigHash" class="def">txSigHash</a> <a href="src/Network-Haskoin-Script-SigHash.html#txSigHash" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Network-Haskoin-Transaction.html#t:Tx">Tx</a></td><td class="doc"><p>Transaction to sign.</p></td></tr><tr><td class="src">-&gt; <a href="Network-Haskoin-Script.html#t:Script">Script</a></td><td class="doc"><p>Output script that is being spent.</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.8.2.0/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>Index of the input that is being signed.</p></td></tr><tr><td class="src">-&gt; <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a></td><td class="doc"><p>What parts of the transaction should be signed.</p></td></tr><tr><td class="src">-&gt; <a href="Network-Haskoin-Crypto.html#t:Hash256">Hash256</a></td><td class="doc"><p>Result hash to be signed.</p></td></tr></table></div><div class="doc"><p>Computes the hash that will be used for signing a transaction.</p></div></div><div class="top"><p class="src"><a name="v:encodeSigHash32" class="def">encodeSigHash32</a> :: <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a> -&gt; <a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a> <a href="src/Network-Haskoin-Script-SigHash.html#encodeSigHash32" class="link">Source</a></p><div class="doc"><p>Encodes a <code><a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a></code> to a 32 bit-long bytestring.</p></div></div><div class="top"><p class="src"><a name="v:isSigAll" class="def">isSigAll</a> :: <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Network-Haskoin-Script-SigHash.html#isSigAll" class="link">Source</a></p><div class="doc"><p>Returns True if the <code><a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a></code> has the value SigAll.</p></div></div><div class="top"><p class="src"><a name="v:isSigNone" class="def">isSigNone</a> :: <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Network-Haskoin-Script-SigHash.html#isSigNone" class="link">Source</a></p><div class="doc"><p>Returns True if the <code><a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a></code> has the value SigNone.</p></div></div><div class="top"><p class="src"><a name="v:isSigSingle" class="def">isSigSingle</a> :: <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Network-Haskoin-Script-SigHash.html#isSigSingle" class="link">Source</a></p><div class="doc"><p>Returns True if the <code><a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a></code> has the value SigSingle.</p></div></div><div class="top"><p class="src"><a name="v:isSigUnknown" class="def">isSigUnknown</a> :: <a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Network-Haskoin-Script-SigHash.html#isSigUnknown" class="link">Source</a></p><div class="doc"><p>Returns True if the <code><a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a></code> has the value SigUnknown.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:TxSignature" class="def">TxSignature</a> <a href="src/Network-Haskoin-Script-SigHash.html#TxSignature" class="link">Source</a></p><div class="doc"><p>Data type representing a <code><a href="Network-Haskoin-Crypto.html#t:Signature">Signature</a></code> together with a <code><a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a></code>. The
 <code><a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a></code> is serialized as one byte at the end of a regular ECDSA
 <code><a href="Network-Haskoin-Crypto.html#t:Signature">Signature</a></code>. All signatures in transaction inputs are of type <code><a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a></code>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:TxSignature" class="def">TxSignature</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:txSignature" class="def">txSignature</a> :: !<a href="Network-Haskoin-Crypto.html#t:Signature">Signature</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:sigHashType" class="def">sigHashType</a> :: !<a href="Network-Haskoin-Script.html#t:SigHash">SigHash</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:TxSignature" class="caption collapser" onclick="toggleSection('i:TxSignature')">Instances</p><div id="section.i:TxSignature" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Data-Eq.html#t:Eq">Eq</a> <a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a></span> <a href="src/Network-Haskoin-Script-SigHash.html#line-171" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Read.html#t:Read">Read</a> <a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a></span> <a href="src/Network-Haskoin-Script-SigHash.html#line-171" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> <a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a></span> <a href="src/Network-Haskoin-Script-SigHash.html#line-171" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../deepseq-1.4.1.1/Control-DeepSeq.html#t:NFData">NFData</a> <a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a></span> <a href="src/Network-Haskoin-Script-SigHash.html#line-173" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:encodeSig" class="def">encodeSig</a> :: <a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a> -&gt; <a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a> <a href="src/Network-Haskoin-Script-SigHash.html#encodeSig" class="link">Source</a></p><div class="doc"><p>Serialize a <code><a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a></code> to a ByteString.</p></div></div><div class="top"><p class="src"><a name="v:decodeSig" class="def">decodeSig</a> :: <a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Data-String.html#t:String">String</a> <a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a> <a href="src/Network-Haskoin-Script-SigHash.html#decodeSig" class="link">Source</a></p><div class="doc"><p>Decode a <code><a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a></code> from a ByteString.</p></div></div><div class="top"><p class="src"><a name="v:decodeCanonicalSig" class="def">decodeCanonicalSig</a> :: <a href="../bytestring-0.10.6.0/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> <a href="../base-4.8.2.0/Data-String.html#t:String">String</a> <a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a> <a href="src/Network-Haskoin-Script-SigHash.html#decodeCanonicalSig" class="link">Source</a></p></div><h1 id="g:7">Evaluation</h1><div class="top"><p class="src"><a name="v:evalScript" class="def">evalScript</a> :: <a href="Network-Haskoin-Script.html#t:Script">Script</a> -&gt; <a href="Network-Haskoin-Script.html#t:Script">Script</a> -&gt; <a href="Network-Haskoin-Script.html#t:SigCheck">SigCheck</a> -&gt; [<a href="Network-Haskoin-Internals.html#t:Flag">Flag</a>] -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Network-Haskoin-Script-Evaluator.html#evalScript" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:verifySpend" class="def">verifySpend</a> <a href="src/Network-Haskoin-Script-Evaluator.html#verifySpend" class="link">Source</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Network-Haskoin-Transaction.html#t:Tx">Tx</a></td><td class="doc"><p>The spending transaction</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.8.2.0/Data-Int.html#t:Int">Int</a></td><td class="doc"><p>The input index</p></td></tr><tr><td class="src">-&gt; <a href="Network-Haskoin-Script.html#t:Script">Script</a></td><td class="doc"><p>The output script we are spending</p></td></tr><tr><td class="src">-&gt; [<a href="Network-Haskoin-Internals.html#t:Flag">Flag</a>]</td><td class="doc"><p>Evaluation flags</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Uses <code><a href="Network-Haskoin-Script.html#v:evalScript">evalScript</a></code> to check that the input script of a spending
 transaction satisfies the output script.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:SigCheck" class="def">SigCheck</a> = [<a href="Network-Haskoin-Script.html#t:ScriptOp">ScriptOp</a>] -&gt; <a href="Network-Haskoin-Script.html#t:TxSignature">TxSignature</a> -&gt; <a href="Network-Haskoin-Crypto.html#t:PubKey">PubKey</a> -&gt; <a href="../base-4.8.2.0/Data-Bool.html#t:Bool">Bool</a> <a href="src/Network-Haskoin-Script-Evaluator.html#SigCheck" class="link">Source</a></p><div class="doc"><p>Defines the type of function required by script evaluating
 functions to check transaction signatures.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>